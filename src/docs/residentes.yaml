paths:
  /residentes:
    get:
      tags:
        - Residentes
      summary: Get all residents
      description: Returns a list of all residents (admin and condoAdmin only)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Residents retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  results:
                    type: integer
                    example: 10
                  data:
                    type: object
                    properties:
                      residentes:
                        type: array
                        items:
                          $ref: '#/components/schemas/Residente'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'

    post:
      tags:
        - Residentes
      summary: Create a new resident
      description: Creates a new resident (admin and condoAdmin only)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateResidenteRequest'
            example:
              unidadId: 123e4567-e89b-12d3-a456-426614174000
              nombre: "Juan Pérez García"
              email: "juan.perez@email.com"
              telefono: "5512345678"
              tipo: Propietario
              fechaIngreso: "2024-01-15T00:00:00.000Z"
              documentoIdentidad: "ABC123456"
              contactoEmergencia: "María Pérez"
              telefonoEmergencia: "5587654321"
              notas: "Residente principal de la unidad"
      responses:
        '201':
          description: Resident created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: Residente creado exitosamente
                  data:
                    type: object
                    properties:
                      residente:
                        $ref: '#/components/schemas/Residente'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '422':
          $ref: '#/components/responses/ValidationError'

  /residentes/unidad/{unidadId}:
    get:
      tags:
        - Residentes
      summary: Get residents by unit
      description: Returns all residents belonging to a specific unit
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: unidadId
          required: true
          schema:
            type: string
            format: uuid
          description: Unit ID
      responses:
        '200':
          description: Residents retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  results:
                    type: integer
                    example: 3
                  data:
                    type: object
                    properties:
                      residentes:
                        type: array
                        items:
                          $ref: '#/components/schemas/Residente'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /residentes/{id}:
    get:
      tags:
        - Residentes
      summary: Get resident by ID
      description: Returns a single resident by ID
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: Resident ID
      responses:
        '200':
          description: Resident retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  data:
                    type: object
                    properties:
                      residente:
                        $ref: '#/components/schemas/Residente'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    put:
      tags:
        - Residentes
      summary: Update resident
      description: Updates resident information (admin and condoAdmin only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: Resident ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateResidenteRequest'
      responses:
        '200':
          description: Resident updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: Residente actualizado exitosamente
                  data:
                    type: object
                    properties:
                      residente:
                        $ref: '#/components/schemas/Residente'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '422':
          $ref: '#/components/responses/ValidationError'

    delete:
      tags:
        - Residentes
      summary: Delete resident
      description: Permanently deletes a resident (admin only)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: Resident ID
      responses:
        '200':
          description: Resident deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: Residente eliminado exitosamente
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'

components:
  schemas:
    Residente:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        unidadId:
          type: string
          format: uuid
          example: 987e6543-e21b-45d6-a789-987654321000
        nombre:
          type: string
          example: "Juan Pérez García"
        email:
          type: string
          format: email
          example: "juan.perez@email.com"
        telefono:
          type: string
          example: "5512345678"
        tipo:
          type: string
          enum: [Propietario, Inquilino, Familiar]
          example: Propietario
        fechaIngreso:
          type: string
          format: date-time
          example: "2024-01-15T00:00:00.000Z"
        documentoIdentidad:
          type: string
          nullable: true
          example: "ABC123456"
        contactoEmergencia:
          type: string
          nullable: true
          example: "María Pérez"
        telefonoEmergencia:
          type: string
          nullable: true
          example: "5587654321"
        notas:
          type: string
          nullable: true
          example: "Residente principal de la unidad"
        activo:
          type: boolean
          example: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateResidenteRequest:
      type: object
      required:
        - unidadId
        - nombre
        - email
        - telefono
        - fechaIngreso
      properties:
        unidadId:
          type: string
          format: uuid
        nombre:
          type: string
          maxLength: 200
        email:
          type: string
          format: email
        telefono:
          type: string
          maxLength: 20
        tipo:
          type: string
          enum: [Propietario, Inquilino, Familiar]
          default: Propietario
        fechaIngreso:
          type: string
          format: date-time
        documentoIdentidad:
          type: string
          maxLength: 50
        contactoEmergencia:
          type: string
          maxLength: 200
        telefonoEmergencia:
          type: string
          maxLength: 20
        notas:
          type: string

    UpdateResidenteRequest:
      type: object
      properties:
        nombre:
          type: string
          maxLength: 200
        email:
          type: string
          format: email
        telefono:
          type: string
          maxLength: 20
        tipo:
          type: string
          enum: [Propietario, Inquilino, Familiar]
        fechaIngreso:
          type: string
          format: date-time
        documentoIdentidad:
          type: string
          maxLength: 50
        contactoEmergencia:
          type: string
          maxLength: 200
        telefonoEmergencia:
          type: string
          maxLength: 20
        notas:
          type: string
        activo:
          type: boolean
